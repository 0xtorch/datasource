{
  "id": "cryptorch-transaction-jp",
  "service": "cryptorch",
  "formatter": {
    "timestamp": ["datetime-jp"],
    "direction": ["string"],
    "assetType": ["string"],
    "assetId": ["string"],
    "amount": ["big-decimal-positive"],
    "actionSource": ["string"],
    "actionOrder": ["string"],
    "actionType": ["string"],
    "actionEvidence": ["string"],
    "app": ["blank", "string"],
    "actionCrossId": ["blank", "string"],
    "actionCrossType": ["blank", "string"],
    "actionLoanId": ["blank", "string"],
    "actionTargetAssetId": ["blank", "string"],
    "comment": ["blank", "string"]
  },
  "parser": {
    "key": ["actionSource", "actionOrder"],
    "parsers": [
      {
        "conditions": [
          {
            "value": {
              "type": "cell",
              "column": "actionType"
            },
            "pattern": "trade"
          }
        ],
        "generators": [
          {
            "type": "trade",
            "source": {
              "type": "cell",
              "column": "actionSource"
            },
            "timestamp": {
              "type": "cell",
              "column": "timestamp"
            },
            "comment": {
              "type": "cell",
              "column": "comment"
            },
            "transfers": [
              {
                "target": [
                  {
                    "column": "direction",
                    "pattern": "in"
                  }
                ],
                "direction": "in",
                "amount": {
                  "type": "text",
                  "value": {
                    "type": "cell",
                    "column": "amount"
                  }
                },
                "asset": {
                  "type": "id",
                  "value": {
                    "type": "join",
                    "values": [
                      {
                        "type": "cell",
                        "column": "assetType"
                      },
                      "/",
                      {
                        "type": "cell",
                        "column": "assetId"
                      }
                    ]
                  },
                  "splitter": "/"
                }
              },
              {
                "target": [
                  {
                    "column": "direction",
                    "pattern": "out"
                  }
                ],
                "direction": "out",
                "amount": {
                  "type": "text",
                  "value": {
                    "type": "cell",
                    "column": "amount"
                  }
                },
                "asset": {
                  "type": "id",
                  "value": {
                    "type": "join",
                    "values": [
                      {
                        "type": "cell",
                        "column": "assetType"
                      },
                      "/",
                      {
                        "type": "cell",
                        "column": "assetId"
                      }
                    ]
                  },
                  "splitter": "/"
                }
              }
            ]
          }
        ]
      }
    ]
  }
}
